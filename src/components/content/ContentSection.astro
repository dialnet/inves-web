---
interface Props {
  title?: string;
  subtitle?: string;
  id?: string;
  background?: "white" | "slate" | "gradient";
  centered?: boolean;
  maxWidth?: "default" | "wide" | "full";
  paddingY?: "small" | "medium" | "large";
  backgroundImage?: string;
}

const {
  title,
  subtitle,
  id,
  background = "white",
  centered = false,
  maxWidth = "default",
  paddingY = "large",
  backgroundImage: rawBackgroundImage,
} = Astro.props;

const base = import.meta.env.BASE_URL.replace(/\/$/, "");
const backgroundImage = rawBackgroundImage?.startsWith("/")
  ? `${base}${rawBackgroundImage}`
  : rawBackgroundImage;

const bgClasses = {
  white: "bg-white",
  slate: "bg-slate-50",
  gradient: "bg-gradient-to-b from-slate-50 to-white",
};

const maxWidthClasses = {
  default: "max-w-5xl",
  wide: "max-w-7xl",
  full: "max-w-full",
};

const paddingClasses = {
  small: "py-12",
  medium: "py-16",
  large: "py-24",
};

const overlayClass = backgroundImage ? "relative z-10" : "";
const containerClass = backgroundImage ? "relative overflow-hidden" : "";
---

<section
  id={id}
  class={`${backgroundImage ? "relative text-white" : bgClasses[background]} ${paddingClasses[paddingY]} ${containerClass}`}
>
  {
    backgroundImage && (
      <>
        <div class="absolute inset-0 z-0">
          <img
            src={backgroundImage}
            alt=""
            class="w-full h-full object-cover"
          />
        </div>
        <div class="absolute inset-0 bg-slate-900/80 z-0" />
      </>
    )
  }

  <div
    class={`container mx-auto px-4 sm:px-6 lg:px-8 ${maxWidthClasses[maxWidth]} ${overlayClass} reveal`}
  >
    {
      (title || subtitle) && (
        <div class={`mb-12 ${centered ? "text-center" : ""}`}>
          {subtitle && (
            <div
              class={`inline-block px-4 py-2 mb-4 ${backgroundImage ? "bg-white/10 text-white backdrop-blur-sm" : "bg-blue-100 text-blue-800"} text-sm font-semibold rounded-full ${centered ? "" : "mb-6"}`}
            >
              {subtitle}
            </div>
          )}
          {title && (
            <h2
              class={`text-4xl md:text-5xl font-bold ${backgroundImage ? "text-white" : "text-slate-900"} mb-6`}
            >
              {title}
            </h2>
          )}
        </div>
      )
    }
    <div class={backgroundImage ? "text-white" : ""}>
      <slot />
    </div>
  </div>
</section>
